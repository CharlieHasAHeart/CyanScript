### Markdown 文本输出规范

为了确保您的 Markdown 文件可以被脚本正确解析并生成符合预期的 Word 文档，请遵循以下样式规范。

#### **标题 (Headings)**

请使用 ATX 样式的标题，即在行首使用井号（`#`）来表示。脚本支持从一级到四级的标题。

- `#` 对应 **标题 1**
- `##` 对应 **标题 2**
- `###` 对应 **标题 3**
- `####` 对应 **标题 4**

**注意：**

- 脚本会自动移除标题中的章节编号，例如 `第 1 章`、`1.1` 或 `一、` 等。因此，您可以在 Markdown 中保留这些编号以便于组织，它们不会出现在最终的 Word 标题中。
- 请在 `#` 和标题文本之间保留一个空格。

**示例：**

```markdown
# 第一章 引言

## 1.1 项目背景

### 1.1.1 需求分析

#### 详细说明
```

---

#### **段落 (Paragraphs)**

普通文本段落将使用 Word 中的 `Normal`（正文）样式。段落之间请使用一个空行来分隔。

**示例：**

```markdown
这是一个段落。

这是另一个段落，与前一个段落之间有一个空行。
```

---

#### **行内代码 (Inline Code)**

使用反引号（` `` `）来包裹行内代码。脚本会为行内代码应用“行内代码”样式，并进行特殊处理以优化显示效果：

- 为了避免中英文混排时的间距问题，代码块前后的空格会被替换为窄空格（thin space）。
- 行内代码中的空格会被替换为不断行空格（non-breaking space），以防止代码在行内被意外断开。

**示例：**

```markdown
在 Python 中，使用 `import os` 来导入操作系统模块。函数 `main()` 是程序的入口。
```

---

#### **代码块 (Code Blocks)**

使用三个反引号（` ``` `）来创建代码块。为了获得最佳的显示效果，请务必指定编程语言。

- 代码块将被格式化为“代码块”样式。
- 如果指定了语言，脚本会在代码块前添加一个“语言：”的标记（例如，“语言：Python”）。

支持的语言简写及映射关系如下：

- `py` -> `Python`
- `python` -> `Python`
- `js` -> `JavaScript`
- `javascript` -> `JavaScript`
- `ts` -> `TypeScript`
- `typescript` -> `TypeScript`
- `json` -> `JSON`
- `yaml` -> `YAML`
- `yml` -> `YAML`
- `bash` -> `Bash`
- `sh` -> `Shell`
- `shell` -> `Shell`

**示例：**

````markdown
```python
import os

def main():
    print("Hello, world!")

if __name__ == "__main__":
    main()
```
````

---

#### **图片 (Images)**

支持多种插入图片的方式。图片将使用模板中的“图片”样式，并自动编号和添加图注。

1.  **标准的 Markdown 图片语法：**

    ```markdown
    ![图片替代文本，将作为图注](path/to/image.png)
    ```

2.  **使用 HTML `<img>` 标签：**

    ```markdown
    <img src="path/to/image.jpg" alt="图片替代文本">
    ```

3.  **使用链接语法（仅限图片链接）：**
    ```markdown
    [图片替代文本](path/to/image.gif)
    ```

**图注生成规则：**

- 图注的格式为 `图X 名称`，其中 `X` 是自动递增的图片编号。
- `名称` 部分来自于图片的替代文本（`alt` 属性）。
- 如果替代文本为空，则会使用不带扩展名的文件名作为名称。

**图片路径：**

- 可以使用绝对路径或相对于 Markdown 文件的相对路径。

---

#### **表格 (Tables)**

使用标准的 Markdown 表格语法。

- 表头和正文将分别应用“表格-表头”和“表格-正文”样式（兼容旧样式名）。
- 支持在表格前添加一个格式为 `表 X 名称` 的段落作为表注。

**示例：**

```markdown
表 1 用户信息表

| 姓名 | 年龄 | 城市 |
| :--- | :--: | ---: |
| 张三 |  30  | 北京 |
| 李四 |  25  | 上海 |
```

**注意：**

- 表注（如 `表1 用户信息表`）必须是紧邻表格上方的独立段落。
- 对齐语法（`:---:`）会被识别，但在最终的 Word 文档中，对齐方式由“表格表头”和“表格正文”样式决定。

---

#### **列表 (Lists)**

支持有序与无序列表，分别应用“列表-有序”和“列表-无序”样式（兼容 `List` / `List Paragraph`）。

**示例：**

```markdown
1. 有序列表项示例
2. 有序列表项示例

- 无序列表项示例
- 无序列表项示例
```

---

#### **引用块 (Blockquotes)**

支持引用块，并根据前缀应用不同样式：

- `提示:` / `提示：` → “提示块”
- `注意:` / `注意：` → “注意块”
- `警告:` / `警告：` → “警告块”
- 其他 → “引用块”

**示例：**

```markdown
> 引用块示例文本。
> 提示：请先配置模板路径再生成文档。
> 注意：模板样式变更后需要重新渲染。
> 警告：不要覆盖未备份的输出文件。
```

---

#### **不支持的样式**

以下 Markdown 样式**不被**当前脚本支持，请避免使用：

- **粗体和斜体 (Bold and Italic)**：使用 `**` 或 `_`。
- **删除线 (Strikethrough)**：使用 `~~`。
- **水平分割线 (Horizontal Rules)**：使用 `---` 或 `***`。
- **超链接 (Hyperlinks)**：非图片链接。
